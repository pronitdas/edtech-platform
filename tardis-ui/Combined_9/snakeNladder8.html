<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Snake and Ladder Game</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            display: flex;
            justify-content: center;
            align-items: center;
            flex-direction: column;
            height: 100vh;
            background-color: #f4f4f4;
        }

        .container {
            text-align: center;
            display: flex;
            flex-direction: column;
            align-items: center;
        }

        #board-container {
            display: flex;
            justify-content: center;
            align-items: center;
            position: relative;
            margin-top: 20px;
        }

        #board {
            display: grid;
            grid-template-columns: repeat(10, 50px);
            grid-template-rows: repeat(10, 50px);
            gap: 2px;
            position: relative;
        }

        .cell {
            width: 50px;
            height: 50px;
            display: flex;
            justify-content: center;
            align-items: center;
            border: 1px solid #000;
            box-sizing: border-box;
            position: relative;
        }

        .player {
            background-color: white;
            border-radius: 50%;
            width: 80%;
            height: 80%;
        }

        .modal {
            display: none;
            position: fixed;
            z-index: 1;
            left: 0;
            top: 0;
            width: 100%;
            height: 100%;
            overflow: auto;
            background-color: rgba(0, 0, 0, 0.4);
            justify-content: center;
            align-items: center;
        }

        .modal-content {
            background-color: #fff;
            padding: 20px;
            border: 1px solid #888;
            width: 300px;
            text-align: center;
        }

        button {
            margin: 5px;
        }

        .viewport {
            perspective: 800px;
            perspective-origin: 50% 200px;
            transform: scale(0.8, 0.8);
            position: absolute;
            right: 50px;
        }

        .cube {
            position: relative;
            margin: 0 auto;
            height: 200px;
            width: 200px;
            transform-style: preserve-3d;
            transform: rotateX(136deg) rotateY(1122deg);
            transition: transform 3s;
        }

        .cube>div {
            position: absolute;
            height: 200px;
            width: 200px;
            background-image: url("https://jordizle.com/static/img/codepen/blank.png");
            opacity: 0.9;
            user-select: none;
        }

        .cube>div>div.cube-image {
            width: 200px;
            height: 200px;
            transform: rotate(180deg);
            line-height: 200px;
            font-size: 80px;
            text-align: center;
            color: #1b9bd8;
            transition: color 600ms;
        }

        .cube>div>div.cube-image.active {
            color: red;
        }

        .cube>div:first-child {
            transform: rotateX(90deg) translateZ(100px);
        }

        .cube>div:nth-child(2) {
            transform: translateZ(100px);
        }

        .cube>div:nth-child(3) {
            transform: rotateY(90deg) translateZ(100px);
        }

        .cube>div:nth-child(4) {
            transform: rotateY(180deg) translateZ(100px);
        }

        .cube>div:nth-child(5) {
            transform: rotateY(-90deg) translateZ(100px);
        }

        .cube>div:nth-child(6) {
            transform: rotateX(-90deg) rotate(180deg) translateZ(100px);
        }

        #snake-animation {
            display: none;
            position: absolute;
            z-index: 1000;
            left: 50%;
            top: 50%;
            transform: translate(-50%, -50%);
        }

        #controls {
            display: flex;
            justify-content: center;
            width: 100%;
            padding: 0 50px;
        }

        #result-box {
            display: none;
            justify-content: center;
            align-items: center;
            width: 200px;
            height: 200px;
            font-size: 80px;
            position: absolute;
            background-color: white;
            z-index: 1000;
            box-shadow: inset 0 0 10px rgba(0, 0, 0, 0.5);
            right: 50px;
        }

        .blue-number {
            color: #1b9bd8;
        }

        .red-number {
            color: red;
        }

        /* .snake {
            width: 50%;
            height: 50%;
            position: absolute;
        } */

        /* .ladder {
            width: 50%;
            height: 50%;
            position: absolute;
            z-index: 2;
        } */
        .ladder {
            position: absolute;
            z-index: 2;
            pointer-events: none;
        }

        .ladder-line {
            stroke: black;
            stroke-width: 2;
        }

        .ladder-rung {
            stroke: black;
            stroke-width: 2;
        }
    </style>
</head>

<body>
    <div class="container">
        <h1>Snake and Ladder Game</h1>
        <div id="board-container">
            <div id="board"></div>
        </div>
        <div class="viewport">
            <div class="cube" id="cube">
                <div class="side">
                    <div class="cube-image">1</div>
                </div>
                <div class="side">
                    <div class="cube-image">2</div>
                </div>
                <div class="side">
                    <div class="cube-image">3</div>
                </div>
                <div class="side">
                    <div class="cube-image">4</div>
                </div>
                <div class="side">
                    <div class="cube-image">5</div>
                </div>
                <div class="side">
                    <div class="cube-image active">6</div>
                </div>
            </div>
        </div>
        <button onclick="rollDice()">Roll Dice</button>
        <div id="status"></div>
    </div>

    <div id="questionModal" class="modal">
        <div class="modal-content">
            <p id="questionText"></p>
            <div id="options"></div>
        </div>
    </div>

    <img id="snake-animation" src="giphy.gif" alt="Snake Animation">
    <svg id="ladder" class="ladder" alt="ladder" width="500" height="500" style="display: none;"></svg>
    <div id="result-box"></div>

    <script>
        const boardSize = 10;
        const board = document.getElementById('board');
        const status = document.getElementById('status');
        const questionModal = document.getElementById('questionModal');
        const questionText = document.getElementById('questionText');
        const optionsDiv = document.getElementById('options');
        const snakeAnimation = document.getElementById('snake-animation');
        const resultBox = document.getElementById('result-box');
        const cube = document.getElementById('cube');
        const ladderSvg = document.getElementById('ladder');
        let playerPosition = 1;
        let correctTargetPos = 0;
        let previousPosition = 0;

        const colors = ['violet', 'indigo', 'blue', 'green', 'yellow', 'orange', 'red'];
        const colorMap = {};

        const snakes = {
            14: 4,
            31: 9,
            38: 20,
            84: 28,
            93: 53,
            95: 73,
            97: 78
        };

        const ladders = {
            3: 22,
            5: 8,
            11: 26,
            20: 29,
            27: 1,
            39: 60,
            51: 67,
            63: 81,
            72: 91,
            88: 100
        };

        const questions = [
            {
                question: "What is the capital of France?",
                options: ["Berlin", "Madrid", "Paris", "Lisbon"],
                answer: "Paris"
            },
            {
                question: "What is 2 + 2?",
                options: ["3", "4", "5", "6"],
                answer: "4"
            },
            {
                question: "Who wrote 'To Kill a Mockingbird'?",
                options: ["Harper Lee", "J.K. Rowling", "Jane Austen", "Mark Twain"],
                answer: "Harper Lee"
            }
        ];


        function getRandomQuestion() {
            if (questions && questions.length > 0) {
                return questions[Math.floor(Math.random() * questions.length)];
            } else {
                return {
                    question: "No questions available. Please upload a file with questions.",
                    options: ["Option 1", "Option 2", "Option 3", "Option 4"],
                    answer: "Option 1"
                };
            }
        }


        document.addEventListener("DOMContentLoaded", () => {
            const snakeGameButton = document.getElementById("snakeGameButton");

            snakeGameButton.addEventListener("click", () => {
                // Load Snake and Ladder Game
                window.location.href = "snakeNladder8.html";
            });
        });

        function createBoard() {
            for (let row = boardSize; row > 0; row--) {
                for (let col = 1; col <= boardSize; col++) {
                    const cell = document.createElement('div');
                    cell.className = 'cell';
                    let cellNumber;
                    if (row % 2 === 0) {
                        cellNumber = (row - 1) * boardSize + col;
                    } else {
                        cellNumber = row * boardSize - col + 1;
                    }
                    cell.id = `cell-${cellNumber}`;
                    cell.textContent = cellNumber;
                    cell.style.backgroundColor = colors[cellNumber % colors.length];

                    if (snakes[cellNumber]) {
                        const snakeImg = document.createElement('img');
                        snakeImg.src = 'snake.png';
                        snakeImg.className = 'snake';
                        snakeImg.style.width = '50%';
                        snakeImg.style.height = '50%';
                        cell.appendChild(snakeImg);
                    }

                    if (ladders[cellNumber]) {
                        const ladderImg = document.createElement('img');
                        ladderImg.src = 'ladder.png';
                        ladderImg.className = 'ladder';
                        ladderImg.style.width = '50%';
                        ladderImg.style.height = '50%';
                        cell.appendChild(ladderImg);
                    }

                    board.appendChild(cell);
                }
            }
            updatePlayerPosition();
        }

        function rollDice() {
            hideLadder();
            hideResultBox();
            cube.style.display = 'block';
            const diceRoll = Math.floor(Math.random() * 6) + 1;
            cube.style.transition = 'none';
            cube.style.transform = 'rotateX(0deg) rotateY(0deg)';
            setTimeout(() => {
                cube.style.transition = 'transform 3s';
                animateDice(diceRoll, () => {
                    status.textContent = `You rolled a ${diceRoll}`;
                    movePlayer(diceRoll);
                });
            }, 10);
        }

        function animateDice(result, callback) {
            resultBox.style.display = 'none';
            cube.style.transform = 'rotateX(' + (Math.random() * 3600) + 'deg) rotateY(' + (Math.random() * 3600) + 'deg)';
            setTimeout(() => {
                const cubeRect = cube.getBoundingClientRect();
                const centerX = cubeRect.left + cubeRect.width / 2;
                const centerY = cubeRect.top + cubeRect.height / 2;
                resultBox.style.top = `${centerY}px`;
                resultBox.style.left = `${centerX}px`;
                resultBox.style.transform = `translate(-50%, -50%)`;
                cube.style.display = 'none';
                showResultBox(result);
                callback();
            }, 3000);
        }

        function showResultBox(number) {
            resultBox.textContent = number;
            resultBox.className = number === 6 ? 'red-number' : 'blue-number';
            resultBox.style.display = 'flex';
        }

        function hideResultBox() {
            resultBox.style.display = 'none';
        }

        function movePlayer(steps) {
            previousPosition = playerPosition;
            playerPosition += steps;

            playerPosition = checkSnakesAndLadders(playerPosition);

            if (playerPosition >= boardSize * boardSize) {
                playerPosition = boardSize * boardSize;
                status.textContent = 'You win!';
            }
            updatePlayerPosition();
        }

        function checkSnakesAndLadders(position) {
            if (snakes[position]) {
                status.textContent = 'Answer the question correctly or get bitten by the snake';
                askQuestion('snake', position, snakes[position]);
                return position;
            }

            if (ladders[position]) {
                status.textContent = 'Answer the question correctly to go up the ladder';
                askQuestion('ladder', position, ladders[position]);
                return position;
            }

            return position;
        }

        function askQuestion(type, currentPos, targetPos) {
            const question = getRandomQuestion();
            questionText.textContent = question.question;
            optionsDiv.innerHTML = '';
            correctTargetPos = targetPos;

            question.options.forEach(option => {
                const button = document.createElement('button');
                button.textContent = option;
                button.onclick = () => handleAnswer(option, question.answer, type, currentPos, targetPos);
                optionsDiv.appendChild(button);
            });

            questionModal.style.display = 'flex';
        }

        function handleAnswer(selectedOption, correctAnswer, type, currentPos, targetPos) {
            questionModal.style.display = 'none';
            if (selectedOption === correctAnswer) {
                if (type === 'snake') {
                    status.textContent = 'Correct! You avoided the snake. Stay in the same position.';
                } else {
                    if (targetPos > currentPos) {
                        status.textContent = `Correct! You go up the ladder to ${targetPos}`;

                        drawLadder(currentPos, targetPos);
                        console.log("ladder draw");
                        playerPosition = targetPos;
                        updatePlayerPosition();
                        checkSnakesAndLadders(targetPos);
                    } else {
                        status.textContent = 'Correct! Stay in the same position.';
                    }
                }
            } else {
                if (type === 'snake') {
                    status.textContent = `Wrong! You are bitten by the snake. Move to ${targetPos}.`;
                    playerPosition = targetPos;
                    showSnakeAnimation();
                    updatePlayerPosition();
                } else {
                    status.textContent = `Wrong! You stay in the same position.`;
                }
            }
        }

        function updatePlayerPosition() {
            document.querySelectorAll('.player').forEach(player => player.remove());
            const playerCell = document.getElementById(`cell-${playerPosition}`);
            const player = document.createElement('div');
            player.className = 'player';
            playerCell.appendChild(player);
        }

        function showSnakeAnimation() {
            snakeAnimation.style.display = 'block';
            setTimeout(() => {
                snakeAnimation.style.display = 'none';
            }, 2000);
        }

        function drawLadder(start, end) {
            const startCell = document.getElementById(`cell-${start}`);
            const endCell = document.getElementById(`cell-${end}`);
            const startRect = startCell.getBoundingClientRect();
            const endRect = endCell.getBoundingClientRect();

            const boardRect = board.getBoundingClientRect();
            const offsetX = boardRect.left;
            const offsetY = boardRect.top;

            const x1 = startRect.left + startRect.width / 2 - offsetX;
            const y1 = startRect.top + startRect.height / 2 - offsetY;
            const x2 = endRect.left + endRect.width / 2 - offsetX;
            const y2 = endRect.top + endRect.height / 2 - offsetY;

            const line1 = document.createElementNS("http://www.w3.org/2000/svg", "line");
            line1.setAttribute('x1', x1 - 5);
            line1.setAttribute('y1', y1);
            line1.setAttribute('x2', x2 - 5);
            line1.setAttribute('y2', y2);
            line1.setAttribute('class', 'ladder-line');
            ladderSvg.appendChild(line1);

            const line2 = document.createElementNS("http://www.w3.org/2000/svg", "line");
            line2.setAttribute('x1', x1 + 5);
            line2.setAttribute('y1', y1);
            line2.setAttribute('x2', x2 + 5);
            line2.setAttribute('y2', y2);
            line2.setAttribute('class', 'ladder-line');
            ladderSvg.appendChild(line2);

            const angle = Math.atan2(y2 - y1, x2 - x1);
            const rungLength = 10;
            const numRungs = Math.floor(Math.sqrt(Math.pow(x2 - x1, 2) + Math.pow(y2 - y1, 2)) / (rungLength * 2));
            for (let i = 1; i <= numRungs; i++) {
                const rungX1 = x1 + (i * 2 * rungLength) * Math.cos(angle);
                const rungY1 = y1 + (i * 2 * rungLength) * Math.sin(angle);
                const rungX2 = rungX1 + rungLength * Math.sin(angle);
                const rungY2 = rungY1 - rungLength * Math.cos(angle);

                const rung = document.createElementNS("http://www.w3.org/2000/svg", "line");
                rung.setAttribute('x1', rungX1 - 5);
                rung.setAttribute('y1', rungY1);
                rung.setAttribute('x2', rungX1 + 5);
                rung.setAttribute('y2', rungY1);
                rung.setAttribute('class', 'ladder-rung');
                ladderSvg.appendChild(rung);
            }

            ladderSvg.style.display = 'block';
        }

        function hideLadder() {
            ladderSvg.style.display = 'none';
            while (ladderSvg.childNodes.length > 0) {
                ladderSvg.removeChild(ladderSvg.lastChild);
            }
        }

        createBoard();
    </script>
</body>

</html>